- **Login Shell** — это как **войти в квартиру через входную дверь** (полная инициализация)

## **1. Login Shell (Логин-шелл)**

### **Что это?**

Это **первый/главный сеанс оболочки**, который запускается при **полноценном входе в систему**.

### **Когда запускается?**

1. **Вход через TTY** (консоль Ctrl+Alt+F1-F6)
    
2. **SSH подключение**: `ssh user@server`
    
3. **`su -` или `su --login`** (с дефисом!)
    
4. **Графический вход** (GDM, LightDM, SDDM) — если настроен запуск шелла
    
5. **`bash --login`**
    

### **Что выполняется (последовательность):**

```bash
# 1. Глобальные настройки (для всех пользователей)
/etc/profile

# 2. Пользовательские настройки (выполняется ПЕРВЫЙ найденный!)
~/.bash_profile    # Приоритет 1
~/.bash_login      # Приоритет 2 (если нет .bash_profile)
~/.profile         # Приоритет 3 (если нет предыдущих)

# 3. Если в ~/.bash_profile есть вызов ~/.bashrc
# (частая практика, но не по умолчанию)
```

### **Что обычно настраивают в login shell файлах?**

- **Экспорт переменных окружения** (`PATH`, `EDITOR`, `LANG`, etc.)
    
- **Запуск стартовых скриптов** (один раз за сессию)
    
- **Системные уведомления** (моти дня, обновления)
    
- **Инициализация сессии** (агенты SSH, GPG)

### **Пример .bash_profile:**

```bash
# Экспорт переменных (наследуются всеми дочерними процессами)
export PATH="$HOME/bin:$PATH"
export EDITOR=vim
export LANG=en_US.UTF-8

# Приветствие
echo "Добро пожаловать, $USER!"

# Запуск .bashrc (если он есть)
if [ -f ~/.bashrc ]; then
    . ~/.bashrc
fi
```

## **Ключевые различия**

|Аспект|Login Shell|Non-Login Shell|
|---|---|---|
|**Когда**|При входе в систему|Внутри уже работающей системы|
|**Файлы**|`/etc/profile`, `~/.bash_profile`|`/etc/bash.bashrc`, `~/.bashrc`|
|**Переменные**|Экспортируются (наследуются)|Локальные (только для этого шелла)|
|**su**|`su - user` или `su --login user`|`su user` (БЕЗ дефиса)|
|**Цель**|Инициализация сессии|Работа в текущей сессии|
[[Практические примеры  loginshel и nonloginshell]]

## **Итог для администратора**

1. **`su user`** — **non-login shell**, выполняет только `~/.bashrc`. Быстро, но без инициализации окружения.
    
2. **`su - user`** — **login shell**, выполняет все init-скрипты. Полноценный вход как будто пользователь логинится заново.
    
3. **Разделение ответственности:**
    
    - **`.bash_profile`** — для всего, что нужно один раз за сессию (переменные окружения)
        
    - **`.bashrc`** — для удобств работы (алиасы, prompt, функции)
        
4. **Для скриптов/автоматизации** всегда явно задавайте нужные переменные, не полагайтесь на настройки шелла.
    

**Запомните:** Если после `su user` не работают переменные/пути — используйте `su - user`. 90% проблем решается дефисом.