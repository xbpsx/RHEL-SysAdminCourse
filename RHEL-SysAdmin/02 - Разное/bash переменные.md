Переменные в Bash — **это фундаментальный инструмент**, который системные администраторы используют постоянно. Давайте разберем всё по порядку.


[[#1. Что такое Bash-переменные и как их использовать]]
[[#2. Где хранятся переменные]]
[[#3. Что дают переменные системным администраторам]]
[[#4. Часто используемые сценарии для системных администраторов]]
[[#5. Практические примеры из реальной жизни]]
[[#6. Полезные команды для работы с переменными]]
[[#7. Важные системные переменные, которые нужно знать]]
[[#8. Советы по безопасности]]
[[#Итог для системного администратора]]

---
## 1. Что такое Bash-переменные и как их использовать

### Базовый синтаксис:

```bash
# Создание переменной
VARIABLE_NAME="value"

# Использование переменной
echo $VARIABLE_NAME
# или
echo ${VARIABLE_NAME}
```

### Важные правила:

- **Нет пробелов** вокруг `=`

- **Регистрозависимые** (`name` и `NAME` — разные переменные)

- **По соглашению** системные переменные в UPPER_CASE

---
## 2. Где хранятся переменные

### Уровни видимости переменных:

#### 1. **Локальные переменные** (только для текущей сессии)

```bash
MY_VAR="local_value"
```

**Исчезают** после закрытия терминала.

#### 2. **Переменные окружения** (экспортированные)

```bash
export MY_VAR="global_value"
```

**Доступны** дочерним процессам и программам.

#### 3. **Постоянные переменные** (файлы конфигурации)

**Для пользователя:**

- `~/.bashrc` — для интерактивных non-login shell

- `~/.bash_profile` — для login shell

- `~/.profile` — альтернатива для login shell

**Системные (для всех пользователей):**

- `/etc/bashrc`

- `/etc/profile`

- `/etc/profile.d/` — каталог для дополнительных скриптов

---
## 3. Что дают переменные системным администраторам

### Главные преимущества:

- **Централизация настроек** — изменение в одном месте

- **Автоматизация** — скрипты становятся гибкими

- **Переносимость** — настройки работают на разных системах

- **Безопасность** — хранение критических данных в одном месте

---
## 4. Часто используемые сценарии для системных администраторов

### Сценарий 1: Настройка рабочего окружения

```bash
# В ~/.bashrc или ~/.bash_profile
export EDITOR=nano
export VISUAL=nano
export PAGER=less

# Цветной вывод
export LS_COLORS="di=1;36:ln=1;35:so=1;32:pi=1;33:ex=1;31:"

# История команд
export HISTSIZE=5000
export HISTFILESIZE=10000
export HISTCONTROL=ignoreboth

# Локализация
export LANG=en_US.UTF-8
export LC_ALL=en_US.UTF-8
```

### Сценарий 2: Пути и директории

```bash
# Часто используемые пути
export SCRIPTS_DIR="$HOME/scripts"
export LOGS_DIR="/var/log"
export BACKUP_DIR="/backup"

# Добавление в PATH
export PATH="$PATH:$HOME/bin:$SCRIPTS_DIR:/usr/local/sbin"

# Быстрая навигация
alias cds="cd $SCRIPTS_DIR"
alias cdlogs="cd $LOGS_DIR"
```

### Сценарий 3: Информация о системе

```bash
# Цвета для разных серверов (очень полезно!)
if [[ "$HOSTNAME" == "prod-server" ]]; then
    export PS1='\[\033[1;31m\][\u@\h \W]\$\[\033[0m\] '
elif [[ "$HOSTNAME" == "dev-server" ]]; then
    export PS1='\[\033[1;33m\][\u@\h \W]\$\[\033[0m\] '
else
    export PS1='\[\033[1;32m\][\u@\h \W]\$\[\033[0m\] '
fi
```

### Сценарий 4: Переменные для мониторинга и логирования

```bash
# Даты и временные метки
export TODAY=$(date +%Y-%m-%d)
export TIMESTAMP=$(date +%Y%m%d_%H%M%S)

# Для скриптов бэкапа
export BACKUP_NAME="backup_${TIMESTAMP}.tar.gz"
export LOG_FILE="/var/log/backup_${TODAY}.log"
```

### Сценарий 5: Сетевые настройки

```bash
# Серверы для быстрого доступа
export WEB_SERVER="192.168.1.10"
export DB_SERVER="192.168.1.20"
export BACKUP_SERVER="192.168.1.30"

# Порты
export SSH_PORT="2222"
export WEB_PORT="8080"
```

### Сценарий 6: Безопасность и аутентификация

```bash
# API ключи (осторожно!)
export AWS_ACCESS_KEY_ID="your_key"
export AWS_SECRET_ACCESS_KEY="your_secret"
export GITHUB_TOKEN="your_token"

# SSH агенти
export SSH_AUTH_SOCK="$HOME/.ssh/agent.socket"
```

### Сценарий 7: Переменные для разработки и отладки

```bash
# Отладка скриптов
export DEBUG="true"
export VERBOSE="1"

# Языковые настройки
export PYTHONPATH="$PYTHONPATH:$HOME/dev/lib"
export GOPATH="$HOME/go"
```


---
## 5. Практические примеры из реальной жизни

### Пример 1: Умное приглашение командной строки

```bash
# В ~/.bashrc
export PS1='\[\033[1;32m\]\u@\h\[\033[0m\]:\[\033[1;34m\]\w\[\033[0m\]\$ '
# Показывает: username@hostname:/current/directory$
```

### Пример 2: Автоматическое определение параметров

```bash
# Определение количества CPU для компиляции
export MAKEFLAGS="-j$(nproc)"

# Настройка paginator'а для MySQL
export MYSQL_PAGER="less -Sin"
```

### Пример 3: Цепочки команд с переменными

```bash
# Резервное копирование с временными метками
export BACKUP_DIR="/backup"
export DATE=$(date +%Y%m%d)
tar -czf "${BACKUP_DIR}/backup_${DATE}.tar.gz" /important/data
```

### Пример 4: Условное выполнение

```bash
# В скриптах
if [[ "$ENVIRONMENT" == "production" ]]; then
    echo "Выполняю в продакшене с осторожностью!"
    # Критические операции
else
    echo "Тестовый режим"
    # Безопасные операции
fi
```

## 6. Полезные команды для работы с переменными

```bash
# Показать все переменные
printenv
# или
env

# Показать конкретную переменную
echo $HOME

# Удалить переменную
unset VARIABLE_NAME

# Сделать переменную read-only (защита от изменений)
readonly IMPORTANT_VAR="cannot_change"

# Проверить, установлена ли переменная
if [ -z "${MY_VAR+x}" ]; then
    echo "MY_VAR не установлена"
fi
```

## 7. Важные системные переменные, которые нужно знать

```bash
$HOME        # Домашняя директория
$USER        # Текущий пользователь
$SHELL       # Текущая оболочка
$PATH        # Пути поиска исполняемых файлов
$PWD         # Текущая рабочая директория
$OLDPWD      # Предыдущая рабочая директория
$HOSTNAME    # Имя хоста
$LANG        # Языковая настройка
$PS1         # Приглашение командной строки
$?           # Код возврата последней команды
$$           # PID текущего shell
```

## 8. Советы по безопасности

### Опасный подход:

```bash
# Пароль в открытом виде (НЕ ДЕЛАЙТЕ ТАК!)
export DB_PASSWORD="secret123"
```

### Безопасный подход:

```bash
# Хранить в отдельном файле с ограничениями
# ~/.secrets (chmod 600)
source ~/.secrets

# Или использовать ключи SSH/шифрование
```

---
## Итог для системного администратора

**Переменные Bash — это ваш центральный узел управления средой.** Они позволяют:

- **Настроить рабочее окружение** под свои привычки

- **Автоматизировать рутину** через гибкие скрипты

- **Единообразно работать** на разных серверах

- **Быстро адаптироваться** к изменениям в инфраструктуре

- **Повысить безопасность** через централизованное управление настройками

**Начните с малого:** добавьте в ваш `~/.bashrc` полезные переменные для путей, редакторов и настроек отображения. По мере роста опыта вы будете находить всё новые способы использования переменных для оптимизации своей работы!