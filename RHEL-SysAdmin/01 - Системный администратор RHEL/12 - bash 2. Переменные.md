
[[bash переменные]]

---
### Локальные переменные

```bash
# user это логин текущего пользователя
# имя системы
user@fedora
```

в bash переменные нужны для нескольких задач. Начнем с локальных переменных, это переменные которые мы сами создаем и нужны они для наших задач, для примера

```bash
touch file1 file2 file3

# мы создали переменную files
# и присвоили ей значение file1
files=file1
```

Значение переменной, мы можем увидеть командой `echo`, вводит текст `stdout` и используется во многих задачах, что бы взять значение нужен `$`

```bash
echo $files
file1
```

Мы можем использовать эту переменную с другими командами, например что-бы посмотреть или удалить файл. 

```bash
ls $files
file1

rm $files
```

> Нужно понимать, что значение переменной это просто текст и с файлом он никак не сваязан, оттого, что мы удалили файл - значение переменной никуда не делось, поэтому мы снова можем его создать `touch $files`

Имя переменной, может содержать цирфы, но не может начинаться с цифры, так же в имени переменной нельзя испорльзовать специальные символы, точку, дефиз и все в таком роде. Но имя можно строчными, заглавными писать. В значение переменной можно указывать, все что угодно.

Если есть **проблемы**

```bash
file="Hello World"
info=files2
```

Одна переменная может быть в другой

```bash
myfiles="Say $file"

echo $myfiles
Say Hello World
```

Если мы не хотим, что бы значения обрабатывались, а были просто текстом, то берем значение в `''`

```bash
myfiles='Say $file'

echo $myfiles
Say $file
```

Самое интересное, то, что в значение переменной мы можем указывать **команду**

```bash
lines=$(tail -5 /etc/passwd | head -2)

#либо ``
lines=$`tail -5 /etc/passwd | head -2`

echo $lines
sshd:x:74:74:Privilege-separated SSH:/usr/share/empty.sshd:/usr/sbin/nologin passim:x:973:973:Local Caching Server:/usr/share/empty:/usr/sbin/nologin
```

Те перменные которые мы задали, существуют только в  текущей bash сессии, обычно **локальные** переменные **используются в скриптах**

Если мы хотим, чтоб перменные работали и в других окнах, можно сохранить их в `.bashrc`

```bash
nano .bashrc

# My var
files="file1"
```

---
### Переменные окружения

В противовес локальным переменным, которые используются в рамках текущей bash сессии или скрипта и не особо нужны другим программам существуют **переменные окружения**.

С помощью команды `env` можно увидеть их список

```bash
davidivashevich@fedora:~$ env
SHELL=/bin/bash
WINDOWID=94055718400928
COLORTERM=truecolor
HISTCONTROL=ignoredups
XDG_MENU_PREFIX=gnome-
QT_IM_MODULES=wayland;ibus
HOSTNAME=fedora
HISTSIZE=1000
SSH_AUTH_SOCK=/run/user/1000/gcr/ssh
SHELL_SESSION_ID=a32879cabb264decba2b899b364d3f84
MEMORY_PRESSURE_WRITE=c29tZSAyMDAwMDAgMjAwMDAwMAA=
XMODIFIERS=@im=ibus
DESKTOP_SESSION=gnome
GPG_TTY=not a tty
EDITOR=/usr/bin/nano
PWD=/home/davidivashevich
XDG_SESSION_DESKTOP=gnome
LOGNAME=davidivashevich
XDG_SESSION_TYPE=wayland
SYSTEMD_EXEC_PID=6278
XAUTHORITY=/run/user/1000/
GDM_LANG=en_US.UTF-8
HOME=/home/davidivashevich
USERNAME=davidivashevich
LANG=en_US.UTF-8
...
```

Как мы заметили, все они с заглавными буквами. Теперь переменные нужны для передачи значений программам.

Например, есть переменная **LANG** которая указывает язык для запускаемых программ. Если, поменять на другой язык и запустить из той же баш сессии условно firefox, то он сменит язык. 

> С помощью таких переменных можно настраивать окружение

Возвращаясь к `env` тут есть пара переменных которые пригодится нам в дальнейшем

```bash
env

# указыаем на домашнюю директорию
# текущего пользователя
HOME=/home/davidivashevich

# указывает на имя системы
HOSTNAME=fedora

# указывает на имя текущего пользователя
USERNAME=davidivashevich
```

Еще одна интересная переменная **PATH**, в этой переменной перечислены директории

```bash
env

PATH=/home/davidivashevich/.local/bin:/home/davidivashevich/bin:/usr/local/bin:/usr/bin
```

Напрмиер войдем в директорию `cd /usr/bin`, здесь огрмное количество файлов, все это исполняемые файлы, то есть программы. В переменной **PATH** перечисленно, где искать эти внешние программы. Когда мы пишем `mkdir`, bash ищет по всех директориях **PATH** наличие такого файла, и если находит, запускает. 

В отличие от локальных переменных, переменные среды передаются дочерним процессом. Например, мы поменяли переменную **LANG** и **firefox** при запуске, прочитал значение этой переменной. **Но мы можем превратить локальную переменную, в переменную окружения. Чтобы испольовать ее в дочерних процессах** с помощью команды `export`

```bash
files=file1
export files
export files=file1
```

Например создадим локальную переменную `test1 tes2`, одну из них экспоритруем с помощью `export` , тут же можно запустить `env`

```bash
test1=test1
test2=test2
export test1
env | grep test1
test1=test1
```

тут же появится **test1**, то есть в рамках текущецй сессии test1 превратися в переменное окружение, запустим другое окно мы там его не найдем. Но если запустить дочернюю сессию **bash** (просто вводим bash в терминале), мы увидим, что у **test1** здесь есть значения, а у **test2** нету. Потому-что дочерние сессии получают значения из переменных окружения. 

Что-бы задать переменное окружение на постоянной основе, нужно редактировать файл, основное предназначение `.bashrc` настиройка алиасов и всяких функции баш для эмулятоара терминала, который мы запускаем в системе. В `.bashrc` задаются настройки для интерактивной оболочки в которой не нужно логинится, то есть например для эмулятора терминала, при запуске он не требует логина при этом нам нужно с ним вручную работать, то есть интерактивно. 

Для случаев когда нам нужно использовать **перменные назависмо от эмулятора** терминала, нам нужен другой файл `.bash_profile` , во многих дистрибутивах этот файл при запуске так же считывает настройки с `.bashrc` 

```bash
#.bash_profile
if [ -f ~/.bashrc ]; then
    . ~/.bashrc
fi
```

Из-за этого чисто технический без разницы, где добавлять переменные, в некторых дистрибутивах этот файл назывется `.profile`. 

> Переменную мы можем задать, как в `.bashrc`, так и в `.bash_profile`, или вообще создать свой файл со всеми алиасами и переменными.

Если мы хотим, чтоб наша переменная **работала для всех пользователей**, то настраивать эти файлы нужно в `/etc/profile` и `/etc/.bashrc` 

Если мы не хотим зависить от bash и использовать любую другую оболочку то лучше указать в `/etc/environment`










